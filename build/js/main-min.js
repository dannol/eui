jQuery(document).ready(function($){function n(e){e.length>0&&setTimeout(function(){e.addClass("bg-loaded"),n(e.next())},150)}function e(n){var e=n.index();r.children("li").eq(e).add(n).addClass("selected"),v?(l.addClass("slide-out").removeClass("selected"),r.children("li").eq(e).addClass("content-visible"),f=!1):t(l,e,0,!0)}function i(){r.find(".selected").removeClass("selected").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){$(this).removeClass("content-visible").off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"),t(d.children("li"),-1,0,!1)}),v&&(l.removeClass("slide-out"),r.find(".content-visible").removeClass("content-visible"),f=!1)}function t(n,e,i,o){0==i&&s(),e!=-1&&0==i&&(i=1);var d=a();d==e&&(d=a()),i<h-1?(n.eq(d).toggleClass("slide-out",o),setTimeout(function(){t(n,e,i+1,o)},150)):i==h-1&&n.eq(d).toggleClass("slide-out",o).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e!=-1?(r.children("li.selected").addClass("content-visible"),n.eq(e).addClass("slide-out").removeClass("selected")):u.hasClass("nav-visible")&&o&&u.addClass("nav-clickable"),n.eq(d).off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"),f=!1})}function a(){var n=Math.floor(Math.random()*C.length),e=C[n];return C.splice(n,1),e}function s(){C.length=0;for(var n=0;n<h;n++)C.push(n)}var o=$(".cd-projects-container"),d=o.find(".cd-projects-previews"),l=d.children("li"),r=o.find(".cd-projects"),c=$(".cd-nav-trigger"),u=$(".cd-primary-nav"),v=$(".no-csstransitions").length>0,f=!1,h=r.find("li").length,C=[];d.on("click","a",function(n){n.preventDefault(),0==f&&(f=!0,c.add(o).addClass("project-open"),e($(this).parent("li")))}),c.on("click",function(n){n.preventDefault(),0==f&&(f=!0,c.hasClass("project-open")?(c.add(o).removeClass("project-open"),i()):c.hasClass("nav-visible")?(c.removeClass("nav-visible"),u.removeClass("nav-clickable nav-visible"),v?l.removeClass("slide-out"):t(d.children("li"),-1,0,!1)):(c.addClass("nav-visible"),u.addClass("nav-visible"),v?l.addClass("slide-out"):t(d.children("li"),-1,0,!0))),v&&(f=!1)}),o.on("click",".scroll",function(){o.animate({scrollTop:$(window).height()},500)}),l.children("a").bgLoaded({afterLoaded:function(){n(l.eq(0))}})}),function($){$.fn.bgLoaded=function(n){var e=this,i={afterLoaded:function(){this.addClass("bg-loaded")}},t=$.extend({},i,n);e.each(function(){var n=$(this),e=n.css("background-image").split(", ");n.data("loaded-count",0),$.each(e,function(i,a){var s=a.replace(/^url\(["']?/,"").replace(/["']?\)$/,"");$("<img/>").attr("src",s).load(function(){$(this).remove(),n.data("loaded-count",n.data("loaded-count")+1),n.data("loaded-count")>=e.length&&t.afterLoaded.call(n)})})})}}(jQuery);